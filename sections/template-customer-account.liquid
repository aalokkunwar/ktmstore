<!-- templates/customers/account.liquid -->

<div class="max-w-7xl mx-auto p-6 lg:p-12">
  <h1 class="text-3xl font-bold text-gray-800 mb-8">My Account</h1>

  <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
    
    <!-- LEFT: Orders (3/4 width) -->
    <div class="lg:col-span-3">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Order History</h2>

      {% paginate customer.orders by 10 %}
        {% if customer.orders.size > 0 %}
          <div class="space-y-6">
            {% for order in customer.orders %}
              <div class="bg-white rounded-xl shadow-md p-6 border border-gray-200">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                  <div>
                    <p class="text-gray-700"><span class="font-semibold">Order #:</span> {{ order.name }}</p>
                    <p class="text-gray-500 text-sm">Placed on {{ order.created_at | date: "%B %d, %Y" }}</p>
                    <p class="text-gray-500 text-sm">Status: <span class="font-medium">{{ order.fulfillment_status_label }}</span></p>
                  </div>
                  <div class="mt-4 sm:mt-0">
                    <span class="text-lg font-semibold text-gray-800">{{ order.total_price | money }}</span>
                  </div>
                </div>

                <!-- Products -->
                <div class="mt-4 border-t pt-4">
                  {% for line_item in order.line_items %}
                    <div class="flex items-center gap-4 py-2">
                      {% if line_item.image %}
                        <img src="{{ line_item.image | img_url: '100x' }}" width="100" height="100" alt="{{ line_item.title }}" class="w-16 h-16 object-cover rounded-md border">
                      {% endif %}
                      <div>
                        <p class="font-medium text-gray-800">{{ line_item.title }}</p>
                        <p class="text-sm text-gray-500">Qty: {{ line_item.quantity }}</p>
                        <p class="text-sm text-gray-500">Price: {{ line_item.price | money }}</p>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endfor %}
          </div>

          <div class="mt-6">
            {{ paginate | default_pagination }}
          </div>
        {% else %}
          <p class="text-gray-500">You haven't placed any orders yet.</p>
        {% endif %}
      {% endpaginate %}
    </div>

    <!-- RIGHT: Account details (1/4 width) -->
    <div class="lg:col-span-1">
      <div class="bg-white rounded-xl shadow-md p-6 border border-gray-200">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4">Account Details</h2>
        <p class="text-gray-700 font-medium">{{ customer.first_name }} {{ customer.last_name }}</p>
        <p class="text-gray-500 text-sm">{{ customer.email }}</p>

        {% if customer.phone %}
          <p class="text-gray-500 text-sm mt-2">ðŸ“ž {{ customer.phone }}</p>
        {% endif %}

        {% if customer.default_address %}
          <div class="mt-4">
            <h3 class="font-semibold text-gray-800 text-sm mb-1">Default Address</h3>
            <p class="text-gray-500 text-sm">
              {{ customer.default_address.address1 }}{% if customer.default_address.address2 %}, {{ customer.default_address.address2 }}{% endif %}
            </p>
            <p class="text-gray-500 text-sm">
              {{ customer.default_address.city }}, {{ customer.default_address.province_code }} {{ customer.default_address.zip }}
            </p>
            <p class="text-gray-500 text-sm">{{ customer.default_address.country }}</p>
          </div>
        {% endif %}

        <div class="mt-6 flex flex-col gap-2">
          <a href="{{ routes.account_addresses_url }}" class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200 text-sm text-center">Manage Addresses</a>
          <a href="{{ routes.account_logout_url }}" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 text-sm text-center">Logout</a>
        </div>
      </div>
    </div>

  </div>
</div>
